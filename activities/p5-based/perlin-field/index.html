<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Perlin Field</title>
    <script src="/custom-elements/custom-navbar.js"></script>
    <script src="/custom-elements/custom-badges.js"></script>
    <script src="/custom-elements/custom-guizero.js"></script>
    <script type="module" src="/custom-elements/custom-code-block.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.1/lib/p5.min.js"></script>
    <script src="/custom-elements/custom-copyright.js"></script>
    <link rel="stylesheet" href="/style.css">
</head>

<body class="container">

    <cc-navbar active="p5" level="3" />

    <h1>Perlin Field
        <cc-badge-medium/>
    </h1>

    <h2 style="color: red;">UNDER CONSTRUCTION - UNDER CONSTRUCTION - UNDER CONSTRUCTION</h2>

    <section>
        <h2>What will I make?</h2>

        <p>A screensaver-like animation with colourful triangles moving smoothly.</p>

        <!-- 
from p5 import *
from random import randint

N = 20

OCTAVES = 8
FALLOFF = 0.4
REZ = 1/100

def setup():
    size(350, 350)
    background(0)
    noise_seed(randint(0, 100))
    noise_detail(OCTAVES, FALLOFF)

def draw():
    t = frame_count / 200
    w = width / (N + 1)
    h = height / (N + 1)
    
    color_mode(RGB)
    background(0)
    color_mode(HSB, 360, 100, 100)
    for c in range(1, N+1):
        x = c * w 
        for r in range(1, N+1):
            y = r * h
            n = noise(x * REZ, y * REZ, t)
            n = map(n, 0.25, 0.75, 0, 1)
            n = constrain(n, 0, 1)
            angle = map(n, 0, 1, 0, TWO_PI)
            hue = degrees(angle)
            
            push_matrix()
            translate(x, y)
            rotate(angle)
            fill(hue, 100, 100)
            no_stroke()
            triangle(7, 0, -7, -4, -7, 4)
            pop_matrix()

def mouse_pressed():
    noise_seed(randint(0, 100))

run()
        -->

        <div id="p5-perlin-field"></div>

        <script>
            new p5(p => {
                const N = 20;
                const OCTAVES = 8;
                const FALLOFF = 0.4;
                const REZ = 1 / 100;

                p.setup = function() {
                    p.createCanvas(350, 350);
                    p.background(0);
                    p.noiseSeed(Math.floor(Math.random() * 100));
                    p.noiseDetail(OCTAVES, FALLOFF);
                };

                p.draw = function() {
                    let t = p.frameCount / 200;
                    let w = p.width / (N + 1);
                    let h = p.height / (N + 1);

                    p.colorMode(p.RGB);
                    p.background(0);
                    p.colorMode(p.HSB, 360, 100, 100);
                    for (let c = 1; c <= N; c++) {
                        let x = c * w;
                        for (let r = 1; r <= N; r++) {
                            let y = r * h;
                            let n = p.noise(x * REZ, y * REZ, t);
                            n = p.map(n, 0.25, 0.75, 0, 1);
                            n = p.constrain(n, 0, 1);
                            let angle = p.map(n, 0, 1, 0, p.TWO_PI);
                            let hue = p.degrees(angle);

                            p.push();
                            p.translate(x, y);
                            p.rotate(angle);
                            p.fill(hue, 100, 100);
                            p.noStroke();
                            p.triangle(7, 0, -7, -4, -7, 4);
                            p.pop();
                        }
                    }
                };

                p.mousePressed = function() {
                    p.noiseSeed(Math.floor(Math.random() * 100));
                };
            }, "p5-perlin-field");
        </script>

        <p>Click the mouse to randomize the animation.</p>
    </section>

    <section>
        <h2>Instructions</h2>
        <ol>
            <li>Open the <a href="https://editor.raspberrypi.org/en/projects/ajar-plank-most" target="_blank">starter project</a> and click the <strong>Run</strong> button.</li>
            <li>Login to be able to save your work.</li>
            <li>...</li>
        </ol>
    </section>

    <section>
        <h2>What can I try next?</h2>
        <p>...</p>
        <!--
        <p>Here are some things you can try to make the app better. They are independent from each other so you can pick just a couple or do them in a different order. If you get stuck, use the <em>Hints</em> button or read the Guizero documentation (see <a href="../index.html">Build an app with Guizero</a>).</p>
        <p>And of course you can also use your imagination and change the app as you like!</p>
        <ul>
            <li>Add a button to <strong>change the background color</strong>.
                <ol>
                    <li>Create a new <cc-gz-pushbutton/> with <code>text="Background"</code> (or an image) and linked to the <code>on_background</code> callback function.</li>
                    <li>Create a new <code>on_background</code> callback function to change the background color of <code>output_text</code>.</li>
                    <details class="hints">
                        <summary>Hints</summary>
                        <ul>
                            <li>Check the existing <code>on_color</code> callback function. It does almost what you need but it changes the foreground color instead of the background color.</li>
                            <li>Check the documentation for <cc-gz-textbox/> and find the property you need to change.</li>
                        </ul>
                    </details>
                </ol>
            </li>
        </ul>
        -->
    </section>

    <cc-copyright></cc-copyright>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

</html>
